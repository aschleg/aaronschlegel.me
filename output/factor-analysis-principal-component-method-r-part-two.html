<!DOCTYPE html>
<html lang="english">
<head>

        <title>Factor Analysis with the Principal Component Method and R Part Two</title>
        <meta charset="utf-8" />
        <link href="https://aaronschlegel.me/feed/all.xml" type="application/atom+xml" rel="alternate" title="Aaron Schlegel's Notebook of Interesting Things Full Atom Feed" />
        <link href="https://aaronschlegel.me/feed/statistics.xml" type="application/atom+xml" rel="alternate" title="Aaron Schlegel's Notebook of Interesting Things Categories Atom Feed" />


        <!-- Mobile viewport optimized: j.mp/bplateviewport -->
        <meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1">
        <meta name="description" content="In the first post on factor analysis, we examined computing the estimated covariance matrix \(S\) of the rootstock data and proceeded to find two factors that fit most of the variance of the data. However, the variables in the data are not on the same scale of measurement, which can cause variables with comparatively large variances to dominate the diagonal of the covariance matrix and the resulting factors. The correlation matrix, therefore, makes more intuitive sense to employ in factor analysis. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var align = "center", indent = "0em", linebreak = "false"; if (false) { align = (screen.width" />
        <meta property="og:site_name" content="Aaron Schlegel's Notebook of Interesting Things" />
        <meta property="og:type" content="article" />
        <meta property="og:title" content="Factor Analysis with the Principal Component Method and R Part Two" />
        <meta property="og:url" content="https://aaronschlegel.me" />
        <meta property="og:description" content="" />
        <meta property="article:published_time" content="2017-02-16 00:00:00-08:00" />
        <meta property="article:modified_time" content="" />
        <meta name="twitter:site" content="@Aaron_Schlegel" />
        <meta name="twitter:creator" content="@Aaron_Schlegel" />
        <meta name="twitter:card" content="In the first post on factor analysis, we examined computing the estimated covariance matrix \(S\) of the rootstock data and proceeded to find two factors that fit most of the variance of the data. However, the variables in the data are not on the same scale of measurement, which can cause variables with comparatively large variances to dominate the diagonal of the covariance matrix and the resulting factors. The correlation matrix, therefore, makes more intuitive sense to employ in factor analysis. if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) { var align = "center", indent = "0em", linebreak = "false"; if (false) { align = (screen.width" />
        <meta name="twitter:card" content="The Blog and Notebooks of Aaron Schlegel" />

        <link rel="stylesheet" type="text/css" href="https://aaronschlegel.me/theme/css/styles.min.css" />
        <link rel="canonical" href="https://aaronschlegel.me/factor-analysis-principal-component-method-r-part-two.html" />

        <script src="https://aaronschlegel.me/theme/js/libs/modernizr-2.6.2.min.js"></script>

              <script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-48350829-2', 'aaronschlegel.me');
                ga('send', 'pageview');

              </script>


</head>

<body id="index" class="home">
    <div class="container">
        <div class="row">

            <div id="navigation" class="navbar row">
              <a href="#" gumby-trigger="#navigation &gt; ul" class="toggle"><i class="icon-menu"></i></a>

              <ul class="columns-right">
                <li><a href="https://aaronschlegel.me/">Home</a></li>

                <li><a href="https://aaronschlegel.me/pages/projects.html">Projects</a></li>

              </ul>
            </div>

<section id="content" class="body">

   <div class="row">
        <div class="eleven columns">
            <header>
              <h2 class="entry-title">
                <a href="https://aaronschlegel.me/factor-analysis-principal-component-method-r-part-two.html" rel="bookmark"
                   title="Permalink to Factor Analysis with the Principal Component Method and R Part Two">Factor Analysis with the Principal Component Method and R Part Two</a></h2>
           
            </header>
            <footer class="post-info">
              <abbr class="published" title="2017-02-16T00:00:00-08:00">
                Thu 16 February 2017
              </abbr>
              <address class="vcard author">By 
                <a class="url fn" href="https://aaronschlegel.me/author/aaron-schlegel.html"> Aaron Schlegel</a>
              </address>
            </footer><!-- /.post-info -->
            <div class="entry-content">
                <p>In the <a href="https://aaronschlegel.me/factor-analysis-principal-component-method-r.html">first post on factor analysis</a>, we
examined computing the estimated covariance matrix <span class="math">\(S\)</span> of the rootstock
data and proceeded to find two factors that fit most of the variance of
the data. However, the variables in the data are not on the same scale
of measurement, which can cause variables with comparatively large
variances to dominate the diagonal of the covariance matrix and the
resulting factors. The correlation matrix, therefore, makes more
intuitive sense to employ in factor analysis. In fact, as we saw
previously, most packages available in R default to using the
correlation matrix when performing factor analysis. There are several
benefits to using <span class="math">\(R\)</span> over <span class="math">\(S\)</span>, not only that it scales non-commensurate
variables, but it is also easier to calculate the factors as the matrix
does not need to be decomposed and estimated like <span class="math">\(S\)</span>.</p>
<h2>Factor Analysis with the Correlation Matrix</h2>
<p>Similar to factor analysis with the covariance matrix, we estimate
<span class="math">\(\Lambda\)</span> which is <span class="math">\(p \times m\)</span> where <span class="math">\(D\)</span> is a diagonal matrix of the
<span class="math">\(m\)</span> largest eigenvalues of <span class="math">\(R\)</span>, and <span class="math">\(C\)</span> is a matrix of the corresponding
eigenvectors as columns.</p>
<div class="math">$$ \hat{\Lambda} = CD^{1/2} = (\sqrt{\theta_1}c_1, \sqrt{\theta_2}c_2, \cdots, \sqrt{\theta_m}c_m) $$</div>
<p>Where <span class="math">\(\theta_1, \theta_2, \cdots, \theta_m\)</span> are the largest eigenvalues
of <span class="math">\(R\)</span>.</p>
<p>Thus the correlation matrix <span class="math">\(R\)</span> does not require decomposition, and we
can proceed directly to finding the eigenvalues and eigenvectors of <span class="math">\(R\)</span>.</p>
<p>Load the rootstock data and name the columns. From the previous post:</p>
<p>The rootstock data contains growth measurements of six different apple
tree rootstocks from 1918 to 1934 (Andrews and Herzberg 1985, pp.
357-360) and were obtained from the <a href="ftp://ftp.wiley.com">companion FTP
site</a> of the book Methods of Multivariate Analysis
by Alvin Rencher. The data contains four dependent variables as follows:</p>
<ul>
<li>trunk girth at four years (mm <span class="math">\(\times\)</span> 100)</li>
<li>extension growth at four years (m)</li>
<li>trunk girth at 15 years (mm <span class="math">\(\times\)</span> 100)</li>
<li>weight of tree above ground at 15 years (lb <span class="math">\(\times\)</span> 1000)</li>
</ul>
<div class="highlight"><pre><span></span><span class="n">root</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#39;ROOT.DAT&#39;</span><span class="p">,</span> <span class="n">col.names</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#39;Tree.Number&#39;</span><span class="p">,</span> <span class="s">&#39;Trunk.Girth.4.Years&#39;</span><span class="p">,</span> <span class="s">&#39;Ext.Growth.4.Years&#39;</span><span class="p">,</span> <span class="s">&#39;Trunk.Girth.15.Years&#39;</span><span class="p">,</span> <span class="s">&#39;Weight.Above.Ground.15.Years&#39;</span><span class="p">))</span>
</pre></div>


<p>Compute the correlation matrix of the data.</p>
<div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">&lt;-</span> <span class="nf">cor</span><span class="p">(</span><span class="n">root</span><span class="p">[,</span><span class="m">2</span><span class="o">:</span><span class="m">5</span><span class="p">])</span>
<span class="nf">round</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">##                              Trunk.Girth.4.Years Ext.Growth.4.Years</span>
<span class="err">## Trunk.Girth.4.Years                         1.00               0.88</span>
<span class="err">## Ext.Growth.4.Years                          0.88               1.00</span>
<span class="err">## Trunk.Girth.15.Years                        0.44               0.52</span>
<span class="err">## Weight.Above.Ground.15.Years                0.33               0.45</span>
<span class="err">##                              Trunk.Girth.15.Years</span>
<span class="err">## Trunk.Girth.4.Years                          0.44</span>
<span class="err">## Ext.Growth.4.Years                           0.52</span>
<span class="err">## Trunk.Girth.15.Years                         1.00</span>
<span class="err">## Weight.Above.Ground.15.Years                 0.95</span>
<span class="err">##                              Weight.Above.Ground.15.Years</span>
<span class="err">## Trunk.Girth.4.Years                                  0.33</span>
<span class="err">## Ext.Growth.4.Years                                   0.45</span>
<span class="err">## Trunk.Girth.15.Years                                 0.95</span>
<span class="err">## Weight.Above.Ground.15.Years                         1.00</span>
</pre></div>


<p>Then find the eigenvalues and eigenvectors of <span class="math">\(R\)</span>.</p>
<div class="highlight"><pre><span></span><span class="n">r.eigen</span> <span class="o">&lt;-</span> <span class="nf">eigen</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="n">r.eigen</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">## eigen() decomposition</span>
<span class="err">## $values</span>
<span class="err">## [1] 2.78462702 1.05412174 0.11733950 0.04391174</span>
<span class="err">## </span>
<span class="err">## $vectors</span>
<span class="err">##           [,1]       [,2]       [,3]       [,4]</span>
<span class="err">## [1,] 0.4713465  0.5600120  0.6431731  0.2248274</span>
<span class="err">## [2,] 0.5089667  0.4544775 -0.7142114 -0.1559013</span>
<span class="err">## [3,] 0.5243109 -0.4431448  0.2413716 -0.6859012</span>
<span class="err">## [4,] 0.4938456 -0.5324091 -0.1340527  0.6743048</span>
</pre></div>


<p>We can check the proportion of each eigenvalue respective to the total
sum of the eigenvalues.</p>
<div class="math">$$ \frac{\sum^p_{i=1} \hat{\lambda}^2_{ij}}{tr(R)} = \frac{\theta_j}{p} $$</div>
<p>Where <span class="math">\(p\)</span> is the number of variables. The quick and dirty loop below
finds the proportion of the total for each eigenvalue and the cumulative
proportion.</p>
<div class="highlight"><pre><span></span><span class="n">cumulative.proportion</span> <span class="o">&lt;-</span> <span class="m">0</span>
<span class="n">prop</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">()</span>
<span class="n">cumulative</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">()</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="n">r.eigen</span><span class="o">$</span><span class="n">values</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">proportion</span> <span class="o">&lt;-</span> <span class="n">i</span> <span class="o">/</span> <span class="nf">dim</span><span class="p">(</span><span class="n">root</span><span class="p">[,</span><span class="m">2</span><span class="o">:</span><span class="m">5</span><span class="p">])[</span><span class="m">2</span><span class="p">]</span>
  <span class="n">cumulative.proportion</span> <span class="o">&lt;-</span> <span class="n">cumulative.proportion</span> <span class="o">+</span> <span class="n">proportion</span>

  <span class="n">prop</span> <span class="o">&lt;-</span> <span class="nf">append</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">proportion</span><span class="p">)</span>
  <span class="n">cumulative</span> <span class="o">&lt;-</span> <span class="nf">append</span><span class="p">(</span><span class="n">cumulative</span><span class="p">,</span> <span class="n">cumulative.proportion</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">data.frame</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">cumulative</span><span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">##         prop cumulative</span>
<span class="err">## 1 0.69615676  0.6961568</span>
<span class="err">## 2 0.26353043  0.9596872</span>
<span class="err">## 3 0.02933488  0.9890221</span>
<span class="err">## 4 0.01097793  1.0000000</span>
</pre></div>


<p>As in the case of the covariance matrix, the first two factors account
for nearly all of the sample variance and thus can proceed with <span class="math">\(m = 2\)</span>
factors.</p>
<p>The eigenvectors corresponding to the two largest eigenvalues are
multiplied by the square roots of their respective eigenvalues as seen
earlier to obtain the factor loadings.</p>
<div class="highlight"><pre><span></span><span class="n">factors</span> <span class="o">&lt;-</span> <span class="nf">t</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">r.eigen</span><span class="o">$</span><span class="n">vectors</span><span class="p">[,</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">])</span> <span class="o">*</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">r.eigen</span><span class="o">$</span><span class="n">values</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">]))</span>
<span class="nf">round</span><span class="p">(</span><span class="n">factors</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">##      [,1]  [,2]</span>
<span class="err">## [1,] 0.79  0.57</span>
<span class="err">## [2,] 0.85  0.47</span>
<span class="err">## [3,] 0.87 -0.45</span>
<span class="err">## [4,] 0.82 -0.55</span>
</pre></div>


<p>Computing the communality remains the same as in the covariance setting.</p>
<div class="highlight"><pre><span></span><span class="n">h2</span> <span class="o">&lt;-</span> <span class="nf">rowSums</span><span class="p">(</span><span class="n">factors</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
</pre></div>


<p>The specific variance when factoring <span class="math">\(R\)</span> is <span class="math">\(1 - \hat{h}^2_i\)</span>.</p>
<div class="highlight"><pre><span></span><span class="n">u2</span> <span class="o">&lt;-</span> <span class="m">1</span> <span class="o">-</span> <span class="n">h2</span>
</pre></div>


<p>According to the documentation of the <code>principal()</code> function (called by
`?principal), there is another statistic called complexity, which is
the number of factors on which a variable has moderate or high loadings
(Rencher, 2002 pp. 431), that is found by:</p>
<div class="math">$$ \frac{(\sum^m_{i=1} \hat{\lambda}^2_i)^2}{\sum^m_{i=1} \hat{\lambda}_i^4} $$</div>
<p>In the most simple structure, the complexity of all the variables is
<span class="math">\(1\)</span>. The complexity of the variables is reduced by performing rotation
which will be seen later.</p>
<div class="highlight"><pre><span></span><span class="n">com</span> <span class="o">&lt;-</span> <span class="nf">rowSums</span><span class="p">(</span><span class="n">factors</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">^</span><span class="m">2</span> <span class="o">/</span> <span class="nf">rowSums</span><span class="p">(</span><span class="n">factors</span><span class="o">^</span><span class="m">4</span><span class="p">)</span>
<span class="n">com</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">## [1] 1.831343 1.553265 1.503984 1.737242</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="nf">mean</span><span class="p">(</span><span class="n">com</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">## [1] 1.656459</span>
</pre></div>


<p>As seen in the previous post, the <code>principal()</code> function from the <a href="https://cran.r-project.org/web/packages/psych/">psych
package</a> performs factor
analysis with the principal component method.</p>
<div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">psych</span><span class="p">)</span>
</pre></div>


<p>Since we are using <span class="math">\(R\)</span> instead of <span class="math">\(S\)</span>, the <code>covar</code> argument remains
<code>FALSE</code> by default. No rotation is done for now, so the <code>rotate</code>
argument is set to <code>none</code>.</p>
<div class="highlight"><pre><span></span><span class="n">root.fa</span> <span class="o">&lt;-</span> <span class="nf">principal</span><span class="p">(</span><span class="n">root</span><span class="p">[,</span><span class="m">2</span><span class="o">:</span><span class="m">5</span><span class="p">],</span> <span class="n">nfactors</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">rotate</span> <span class="o">=</span> <span class="s">&#39;none&#39;</span><span class="p">)</span>
<span class="n">root.fa</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">## Principal Components Analysis</span>
<span class="err">## Call: principal(r = root[, 2:5], nfactors = 2, rotate = &quot;none&quot;)</span>
<span class="err">## Standardized loadings (pattern matrix) based upon correlation matrix</span>
<span class="err">##                               PC1   PC2   h2    u2 com</span>
<span class="err">## Trunk.Girth.4.Years          0.79  0.57 0.95 0.051 1.8</span>
<span class="err">## Ext.Growth.4.Years           0.85  0.47 0.94 0.061 1.6</span>
<span class="err">## Trunk.Girth.15.Years         0.87 -0.45 0.97 0.027 1.5</span>
<span class="err">## Weight.Above.Ground.15.Years 0.82 -0.55 0.98 0.022 1.7</span>
<span class="err">## </span>
<span class="err">##                        PC1  PC2</span>
<span class="err">## SS loadings           2.78 1.05</span>
<span class="err">## Proportion Var        0.70 0.26</span>
<span class="err">## Cumulative Var        0.70 0.96</span>
<span class="err">## Proportion Explained  0.73 0.27</span>
<span class="err">## Cumulative Proportion 0.73 1.00</span>
<span class="err">## </span>
<span class="err">## Mean item complexity =  1.7</span>
<span class="err">## Test of the hypothesis that 2 components are sufficient.</span>
<span class="err">## </span>
<span class="err">## The root mean square of the residuals (RMSR) is  0.03 </span>
<span class="err">##  with the empirical chi square  0.39  with prob &lt;  NA </span>
<span class="err">## </span>
<span class="err">## Fit based upon off diagonal values = 1</span>
</pre></div>


<p>The output of the <code>principal()</code> function agrees with our calculations.</p>
<h2>Factor Rotation with Varimax Rotation</h2>
<p>Rotation moves the axes of the loadings to produce a more simplified
structure of the factors to improve interpretation. Therefore the goal
of rotation is to find an interpretable pattern of the loadings where
variables are clustered into groups corresponding to the factors. We
will see that a successful rotation yields a complexity closer to <span class="math">\(1\)</span>,
which denotes the variables load highly on only one factor.</p>
<p>One of the most common approaches to rotation is <a href="https://en.wikipedia.org/wiki/Varimax_rotation">varimax
rotation</a>, which is a
type of orthogonal rotation (axes remain perpendicular). The varimax
technique seeks loadings that maximize the variance of the squared
loadings in each column of the rotated matrix <span class="math">\(\hat{\Lambda}*\)</span>.</p>
<p>The <code>varimax()</code> function is used to find the rotated factor loadings.
For those interested, the R code for the <code>varimax()</code> function can be
found <a href="https://en.wikipedia.org/wiki/Talk:Varimax_rotation">here</a>.</p>
<div class="highlight"><pre><span></span><span class="n">factors.v</span> <span class="o">&lt;-</span> <span class="nf">varimax</span><span class="p">(</span><span class="n">factors</span><span class="p">)</span><span class="o">$</span><span class="n">loadings</span>
<span class="nf">round</span><span class="p">(</span><span class="n">factors.v</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">## </span>
<span class="err">## Loadings:</span>
<span class="err">##      [,1] [,2]</span>
<span class="err">## [1,] 0.16 0.96</span>
<span class="err">## [2,] 0.28 0.93</span>
<span class="err">## [3,] 0.94 0.29</span>
<span class="err">## [4,] 0.97 0.19</span>
<span class="err">## </span>
<span class="err">##                 [,1]  [,2]</span>
<span class="err">## SS loadings    1.928 1.907</span>
<span class="err">## Proportion Var 0.482 0.477</span>
<span class="err">## Cumulative Var 0.482 0.959</span>
</pre></div>


<p>The varimax rotation was rather successful in finding a rotation that
simplified the complexity of the variables. The first two variables now
load highly on the second factor while the remaining two variables load
primarily on the first factor.</p>
<p>Since we used an orthogonal rotation technique, the communalities will
not change.</p>
<div class="highlight"><pre><span></span><span class="n">h2.v</span> <span class="o">&lt;-</span> <span class="nf">rowSums</span><span class="p">(</span><span class="n">factors.v</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="n">h2.v</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">## [1] 0.9492403 0.9390781 0.9725050 0.9779253</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">h2</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">## [1] 0.9492403 0.9390781 0.9725050 0.9779253</span>
</pre></div>


<p>Thus the specific variances will also be unchanged.</p>
<div class="highlight"><pre><span></span><span class="n">u2.v</span> <span class="o">&lt;-</span> <span class="m">1</span> <span class="o">-</span> <span class="n">h2.v</span>
<span class="n">u2.v</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">## [1] 0.05075965 0.06092192 0.02749496 0.02207470</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">u2</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">## [1] 0.05075965 0.06092192 0.02749496 0.02207470</span>
</pre></div>


<p>As stated previously, the complexity of the variables on the rotated
factors should be closer to <span class="math">\(1\)</span> compared to the non-rotated complexity.</p>
<div class="highlight"><pre><span></span><span class="n">com.v</span> <span class="o">&lt;-</span> <span class="nf">rowSums</span><span class="p">(</span><span class="n">factors.v</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">^</span><span class="m">2</span> <span class="o">/</span> <span class="nf">rowSums</span><span class="p">(</span><span class="n">factors.v</span><span class="o">^</span><span class="m">4</span><span class="p">)</span>
<span class="n">com.v</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">## [1] 1.054355 1.179631 1.185165 1.074226</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="nf">mean</span><span class="p">(</span><span class="n">com.v</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">## [1] 1.123344</span>
</pre></div>


<p>The complexity is rather close to <span class="math">\(1\)</span> which provides us further
acknowledgment the factors are now in a more simplified structure.</p>
<p>Setting the <code>rotation</code> argument to <code>varimax</code> in the <code>principal()</code>
function outputs the rotated factors and corresponding statistics.</p>
<div class="highlight"><pre><span></span><span class="n">root.fa2</span> <span class="o">&lt;-</span> <span class="nf">principal</span><span class="p">(</span><span class="n">root</span><span class="p">[,</span><span class="m">2</span><span class="o">:</span><span class="m">5</span><span class="p">],</span> <span class="n">nfactors</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">rotate</span> <span class="o">=</span> <span class="s">&#39;varimax&#39;</span><span class="p">)</span>
<span class="n">root.fa2</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="err">## Principal Components Analysis</span>
<span class="err">## Call: principal(r = root[, 2:5], nfactors = 2, rotate = &quot;varimax&quot;)</span>
<span class="err">## Standardized loadings (pattern matrix) based upon correlation matrix</span>
<span class="err">##                               RC1  RC2   h2    u2 com</span>
<span class="err">## Trunk.Girth.4.Years          0.16 0.96 0.95 0.051 1.1</span>
<span class="err">## Ext.Growth.4.Years           0.28 0.93 0.94 0.061 1.2</span>
<span class="err">## Trunk.Girth.15.Years         0.94 0.29 0.97 0.027 1.2</span>
<span class="err">## Weight.Above.Ground.15.Years 0.97 0.19 0.98 0.022 1.1</span>
<span class="err">## </span>
<span class="err">##                        RC1  RC2</span>
<span class="err">## SS loadings           1.94 1.90</span>
<span class="err">## Proportion Var        0.48 0.48</span>
<span class="err">## Cumulative Var        0.48 0.96</span>
<span class="err">## Proportion Explained  0.50 0.50</span>
<span class="err">## Cumulative Proportion 0.50 1.00</span>
<span class="err">## </span>
<span class="err">## Mean item complexity =  1.1</span>
<span class="err">## Test of the hypothesis that 2 components are sufficient.</span>
<span class="err">## </span>
<span class="err">## The root mean square of the residuals (RMSR) is  0.03 </span>
<span class="err">##  with the empirical chi square  0.39  with prob &lt;  NA </span>
<span class="err">## </span>
<span class="err">## Fit based upon off diagonal values = 1</span>
</pre></div>


<h2>Interpretation of Factors</h2>
<p>The factor analysis performed on the rootstock data yielded two latent
variables that fit and explain the variance of the data quite
sufficiently. We see both variables relating to measurements at four
years load heavily on factor 2 while the 15-year measurements load
mainly on the first factor. Thus we could designate names for the
factors, or latent variables, such as '15 years growth' and '4 years
growth', respectively. There isn't any standard way of 'naming' factors
as the interpretation can vary widely between each case. In this
example, the factors make intuitive sense based on how they load on the
variables; however, factors resulting from a factor analysis may not
always make logic sense to the original data. If the resulting factors
do not seem logical, changes to the approach such as adjusting the
number of factors or the threshold of the loadings deemed important, or
even a different method of rotation can be done to improve
interpretation.</p>
<h2>References</h2>
<p><a href="https://amzn.to/39gsldt">Rencher, A. C. (2002). Methods of multivariate analysis. New York: J. Wiley.</a></p>
<p><a href="https://en.wikipedia.org/wiki/Talk:Varimax_rotation">https://en.wikipedia.org/wiki/Talk:Varimax_rotation</a></p>
<p><a href="https://en.wikipedia.org/wiki/Varimax_rotation">https://en.wikipedia.org/wiki/Varimax_rotation</a></p>
<p><a href="http://web.stanford.edu/class/psych253/tutorials/FactorAnalysis.html">http://web.stanford.edu/class/psych253/tutorials/FactorAnalysis.html</a></p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

                <h3 style="margin-top: 2em;">Related Posts</h3>

                    <ul class="blank">
                        <li><a href="https://aaronschlegel.me/factor-analysis-principal-component-method-r.html">Factor Analysis with the Principal Component Method and R</a></li>
                        <li><a href="https://aaronschlegel.me/factor-analysis-iterated-factor-method-r.html">Factor Analysis with the Iterated Factor Method and R</a></li>
                        <li><a href="https://aaronschlegel.me/tukeys-test-post-hoc-analysis.html">Tukey's Test for Post-Hoc Analysis</a></li>
                        <li><a href="https://aaronschlegel.me/kruskal-wallis-one-way-analysis-variance-ranks.html">Kruskal-Wallis One-Way Analysis of Variance of Ranks</a></li>
                        <li><a href="https://aaronschlegel.me/quadratic-discriminant-analysis-several-groups.html">Quadratic Discriminant Analysis of Several Groups</a></li>
                    </ul>
            </div><!-- /.entry-content -->



        </div><!-- /.eleven.columns -->

<div class="three columns">

        <h3>Categories</h3>
        <ul class="blank">
                <li><a href="https://aaronschlegel.me/category/analysis.html">Analysis</a></li>
                <li><a href="https://aaronschlegel.me/category/calculus.html">Calculus</a></li>
                <li><a href="https://aaronschlegel.me/category/finance.html">Finance</a></li>
                <li><a href="https://aaronschlegel.me/category/linear-algebra.html">Linear Algebra</a></li>
                <li><a href="https://aaronschlegel.me/category/machine-learning.html">Machine Learning</a></li>
                <li><a href="https://aaronschlegel.me/category/nasapy.html">nasapy</a></li>
                <li><a href="https://aaronschlegel.me/category/petpy.html">petpy</a></li>
                <li><a href="https://aaronschlegel.me/category/poetpy.html">poetpy</a></li>
                <li><a href="https://aaronschlegel.me/category/python.html">Python</a></li>
                <li><a href="https://aaronschlegel.me/category/r.html">R</a></li>
                <li><a href="https://aaronschlegel.me/category/sql.html">SQL</a></li>
                <li><a href="https://aaronschlegel.me/category/statistics.html">Statistics</a></li>
        </ul>


    <h3>Recent Posts</h3>

    <ul class="blank">
            <li>
              <a href="https://aaronschlegel.me/van-der-waerdens-normal-scores-test.html">Van der Waerden's Normal Scores Test</a>
            </li>
            <li>
              <a href="https://aaronschlegel.me/generalized-black-scholes-formula-european-options.html">The Generalized Black-Scholes Formula for European Options</a>
            </li>
            <li>
              <a href="https://aaronschlegel.me/get-all-nasa-astronomy-pictures-day-2019.html">Get All NASA Astronomy Pictures of the Day from 2019</a>
            </li>
            <li>
              <a href="https://aaronschlegel.me/analyzing-next-decade-earth-close-approaching-objects-nasapy.html">Analyzing the Next Decade of Earth Close-Approaching Objects with nasapy</a>
            </li>
            <li>
              <a href="https://aaronschlegel.me/plot-earth-fireball-impacts-nasapy-pandas-folium.html">Plot Earth Fireball Impacts with nasapy, pandas and folium</a>
            </li>
            <li>
              <a href="https://aaronschlegel.me/integration-by-parts.html">Integration by Parts</a>
            </li>
    </ul>

        <nav class="widget">
          <h3>Blogroll</h3>
          <ul class="blank">
            <li>
                <a href="https://www.r-bloggers.com">R-Bloggers</a>
            </li>
          </ul>
        </nav>

</div> </div><!-- /.row -->


</section>



       </div><!-- /.row -->
    </div><!-- /.container -->
       <div class="container.nopad bg">
        <footer id="credits" class="row">
          <div class="seven columns left-center">

                   <address id="about" class="vcard body">
                    Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                    which takes great advantage of <a href="http://python.org">Python</a>.
                    <br />
                    Based on the <a target="_blank" href="http://gumbyframework.com">Gumby Framework</a>
                    </address>
          </div>


          <div class="seven columns">
            <div class="row">
              <ul class="socbtns">

                <li><div class="btn primary"><a href="https://github.com/aschleg" target="_blank">Github</a></div></li>

                <li><div class="btn twitter"><a href="http://www.twitter.com/Aaron_Schlegel" target="_blank">Twitter</a></div></li>


                <li><div class="btn danger"><a href="https://plus.google.com/u/0/102881569650657098667" target="_blank">Google+</a></div></li>

              </ul>
            </div>
          </div>
        </footer>

    </div>


  <script src="https://aaronschlegel.me/theme/js/libs/jquery-1.9.1.min.js"></script>
  <script src="https://aaronschlegel.me/theme/js/libs/gumby.min.js"></script>
  <script src="https://aaronschlegel.me/theme/js/plugins.js"></script>
</body>
</html>